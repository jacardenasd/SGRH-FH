================================================================================
GUÃA FINAL - GENERACIÃ“N DE DATOS DEMO CLIMA LABORAL
================================================================================

PROBLEMA ORIGINAL:
- El sistema mostraba 0 elegibles a pesar de intentar crear empleados
- Causa: RestricciÃ³n UNIQUE en (empresa_id, no_emp, rfc_base) causaba conflictos
- SoluciÃ³n: Script "setup_smart.php" que limpia y crea empleados con valores Ãºnicos

================================================================================
SOLUCIÃ“N FINAL - TRES OPCIONES
================================================================================

ðŸŽ¯ OPCIÃ“N A: RECOMENDADA - Setup Inteligente
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
URL: http://localhost/sgrh/public/setup_smart.php

âœ… Ventajas:
  - Crea automÃ¡ticamente empleados de demo
  - Considera restricciones UNIQUE
  - Genera todos los datos en un clic
  - Muestra resumen detallado
  - MÃ¡s confiable que las anteriores

ðŸ“ Pasos:
1. Abre: http://localhost/sgrh/public/setup_smart.php
2. Espera a que termine
3. Haz clic en "Ver Resultados"
4. Â¡Listo!

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ”¬ OPCIÃ“N B: Con Debug Detallado
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
URL: http://localhost/sgrh/public/setup_debug.php

Ãšsalo si quieres ver exactamente quÃ© estÃ¡ pasando en cada paso:
1. Muestra cuÃ¡ntas unidades hay
2. Intenta crear empleados individuales
3. Muestra errores especÃ­ficos
4. Verifica la estructura de la tabla
5. Genera elegibles

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“Š OPCIÃ“N C: DiagnÃ³stico Completo
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
URL: http://localhost/sgrh/public/diagnostico_clima.php

Muestra el estado actual sin generar datos:
1. Estado de conexiÃ³n
2. Cantidad de perÃ­odos
3. Cantidad de reactivos
4. Unidades organizacionales
5. Empleados y sus estatus
6. Elegibles ya generados
7. Respuestas ya generadas

================================================================================
ENTENDIENDO EL PROBLEMA TÃ‰CNICO
================================================================================

La tabla 'empleados' tiene una restricciÃ³n UNIQUE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UNIQUE INDEX `uq_emp_empresa_noemp_rfc`(           â”‚
â”‚   empresa_id,  -- El ID de empresa                â”‚
â”‚   no_emp,      -- NÃºmero de empleado              â”‚
â”‚   rfc_base     -- RFC del empleado                â”‚
â”‚ )                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Esto significa:
âŒ NO se puede insertar dos empleados con el mismo:
   - no_emp EN LA MISMA empresa_id
   - rfc_base EN LA MISMA empresa_id

âœ… SÃ se puede insertar si:
   - El no_emp es diferente
   - El rfc_base es diferente
   - Aunque sea en la misma empresa

CÃ“MO LO SOLUCIONA setup_smart.php:
1. Primero BORRA todos los empleados demo anteriores
   DELETE FROM empleados WHERE no_emp LIKE 'DEMO%'

2. Luego crea nuevos con valores ÃšNICOS usando timestamp:
   - no_emp = "DEMO" + (timestamp * 20 + contador) â†’ Ãºnico cada vez
   - rfc = "RFC" + (timestamp * 20 + contador) â†’ Ãºnico cada vez

3. Esto garantiza que no hay conflictos de UNIQUE

================================================================================
ARCHIVOS DISPONIBLES
================================================================================

Web (Navegador):
â”œâ”€â”€ setup_smart.php .................. â­ RECOMENDADO - Setup inteligente
â”œâ”€â”€ setup_debug.php .................. Debug detallado paso a paso
â”œâ”€â”€ diagnostico_clima.php ............ DiagnÃ³stico sin generaciÃ³n
â”œâ”€â”€ test_db.php ...................... Test rÃ¡pido de tablas
â”œâ”€â”€ clima_generar_demo.php ........... Original (mejorado)
â””â”€â”€ setup_integral.php ............... VersiÃ³n anterior

SQL/Manual:
â”œâ”€â”€ generar_demo_clima.sql ........... Script SQL puro
â”œâ”€â”€ setup_demo_data.sql .............. Setup bÃ¡sico SQL
â””â”€â”€ ejecutar_demo_clima.bat .......... Batch de Windows

DocumentaciÃ³n:
â”œâ”€â”€ HERRAMIENTAS_DIAGNOSTICO.txt .... GuÃ­a de herramientas
â”œâ”€â”€ SOLUCION_CERO_ELEGIBLES.txt ..... Registro de soluciones
â””â”€â”€ mds/GENERAR_DEMO_CLIMA.md ....... DocumentaciÃ³n markdown

================================================================================
FLUJO RECOMENDADO
================================================================================

Paso 1: Entra a Setup Inteligente
         http://localhost/sgrh/public/setup_smart.php

Paso 2: Lee el resumen (muestra cuÃ¡ntos datos se generaron)
         - Empleados activos creados
         - Elegibles generados
         - Respuestas generadas

Paso 3: Haz clic en "Ver Resultados"
         Va a /sgrh/public/clima_resultados.php

Paso 4: Â¡Disfruta los datos demo!
         Ahora tienes datos reales para trabajar

================================================================================
TROUBLESHOOTING
================================================================================

â“ Pregunta: Â¿Por quÃ© antes mostraba 0 elegibles?
âœ… Respuesta: Los empleados no se estaban creando correctamente por:
   - INSERT IGNORE fallando silenciosamente
   - RestricciÃ³n UNIQUE causando conflictos
   - Valores duplicados en no_emp/rfc

â“ Pregunta: Â¿setup_smart.php es definitivo?
âœ… Respuesta: SÃ­, resuelve todos los problemas conocidos

â“ Pregunta: Â¿Puedo ejecutarlo mÃºltiples veces?
âœ… Respuesta: SÃ­, borra los empleados demo antiguos primero

â“ Pregunta: Â¿QuÃ© pasa con los datos existentes?
âœ… Respuesta: Solo borra empleados con no_emp LIKE 'DEMO%'
             Los demÃ¡s empleados se mantienen intactos

â“ Pregunta: Â¿Se pueden modificar los datos despuÃ©s?
âœ… Respuesta: SÃ­ completamente, son datos normales

================================================================================
VERIFICACIÃ“N FINAL
================================================================================

DespuÃ©s de ejecutar setup_smart.php, deberÃ­as ver:

âœ… Empleados activos creados: > 0 (mÃ­nimo 20)
âœ… Elegibles generados: > 0
âœ… Respuestas generadas: > 0 (empleados Ã— reactivos)
âœ… Reactivos: 48 (estÃ¡ndar)

Si ves 0 en cualquier cosa:
1. Abre setup_debug.php para ver dÃ³nde falla
2. Verifica que la base de datos estÃ© corriendo
3. Verifica que el SQL dump fue importado correctamente

================================================================================
PRÃ“XIMOS PASOS DESPUÃ‰S DE GENERAR DATOS
================================================================================

1. Ver Resultados de Clima Laboral:
   http://localhost/sgrh/public/clima_resultados.php

2. Revisar Resultados por Unidad:
   http://localhost/sgrh/public/clima_resultados_mi_unidad.php

3. Analizar Datos en Dashboards:
   Busca los mÃ³dulos de anÃ¡lisis de clima laboral

4. Generar Reportes:
   Accede a los generadores de reportes si existen

================================================================================
CONTACTO / SOPORTE
================================================================================

Si hay problemas:
1. Ejecuta: http://localhost/sgrh/public/setup_debug.php
2. Lee los mensajes de error
3. Verifica los logs en: c:\MAMP\logs\php_error.log
4. Revisa que sgrh.sql fue importado completamente

================================================================================
CONCLUSIÃ“N
================================================================================

setup_smart.php ES LA FORMA DEFINITIVA Y RECOMENDADA DE:
âœ… Generar datos demo de clima laboral
âœ… Manejar restricciones de tabla
âœ… Crear elegibles automÃ¡ticamente
âœ… Generar respuestas realistas
âœ… Publicar resultados

Â¡Ãšsalo y disfruta los datos! ðŸš€

================================================================================
FECHA: Febrero 4, 2026
ESTADO: âœ… PROBADO Y FUNCIONANDO
================================================================================
